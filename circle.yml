machine:
  node:
    version: 6.9.2
  environment:
    NODE_ENV: ci # default is test which suppresses errors in lerna
  post:
    - chromedriver --port=4444 --url-base=wd/hub:
        background: true
dependencies:
  post:
    - bower install
    - lerna bootstrap
  cache_directories:
    - "node_modules"
    - "packages/components/node_modules"
    - "packages/eslint-config-orion/node_modules"
    - "packages/react-playground/node_modules"
    - "packages/scripts/node_modules"
    - "packages/storybook/node_modules"
    - "packages/style/node_modules"
    - "bower_components"
test:
  pre:
    - npm run compile
    - cd packages/storybook && NODE_ENV=development npm start:
        background: true
  override:
    - npm run test-ci
    - gemini test gemini/*
